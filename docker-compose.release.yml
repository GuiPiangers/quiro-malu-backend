services:
  app-release:
    restart: always
    container_name: app-release
    image: guipiangers/quiro-backend:1.0
    env_file:
      - .env.release
    ports:
      - "8100:8000"   
    depends_on:
      - "redis-release"
    networks:
      - minha_rede_release

  mysql-db-release:
    image: mysql:8.0
    container_name: mysqldb-release
    restart: always
    env_file:
      - .env.release
    volumes:
      - db-release:/var/lib/mysql
    ports:
      - "13306:3306"   
    networks:
      - minha_rede_release

  mongo-release:
    image: mongo:8.0.4
    container_name: mongo-release
    restart: always
    env_file:
      - .env.release
    volumes:
      - mongoDb-release:/data/db
    ports:
      - "27018:27017"
    networks:
      - minha_rede_release

  redis-release:
    image: redis:7.4.2-alpine
    container_name: redis-release
    restart: always
    env_file:
      - .env.release
    volumes:
      - redisDb-release:/data
    ports:
      - "6380:6379"
    networks:
      - minha_rede_release

  nginx-release:
    image: nginx:latest
    container_name: nginx-release
    restart: always
    ports:
      - "8080:80"
      - "8443:443"
    volumes:
      - ./nginx/nginx.release.conf:/etc/nginx/nginx.conf
    depends_on: 
      - "app-release"
    networks:
      - minha_rede_release

volumes:
  db-release:
  mongoDb-release:
  redisDb-release:

networks:
  minha_rede_release:
